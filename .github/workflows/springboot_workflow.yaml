name: SpringBoot Microservice

defaults:
    run:
        shell: bash
        working-directory: demo

on:
    push:

    workflow_dispatch:


jobs:
    container-demo:
        runs-on: ubuntu-latest
        container:
            image: eclipse-temurin:17-jdk
        
        steps:
            - name: checkout
              uses: actions/checkout@v4.1.1

            - name: Check java version
              run: java --version
    
    springboot-build:
        runs-on: ubuntu-latest
        #lo corremos en un container porque necesitamos java 17 y por defecto el runner usa java 11
        container:
            image: eclipse-temurin:17-jdk
        outputs:
            success: ${{ steps.build.outputs.result }}

        steps:
            - name: Checkout
              uses: actions/checkout@v4.1.1
            
            - name: Build
              id: build
              run: |
                java --version
                ./gradlew build
                echo "result=OK" >> $GITHUB_OUTPUT

    springboot-container:
        runs-on: ubuntu-latest
        needs: springboot-build

        steps:
            - name: Checkout
              uses: actions/checkout@v4.1.1

            - name: Build Container
              run: |
                echo ${{ needs.springboot-build.outputs.success }}




            